datasource db {
  provider = "postgresql"
}

generator client {
  provider = "prisma-client-js"
}

model User {
  id        Int      @id @default(autoincrement())
  email     String   @unique
  password  String
  profile   UserProfile?
  workouts  Workout[]
  goals     Goal[]
  createdAt DateTime @default(now())
}

model UserProfile {
  id              Int      @id @default(autoincrement())
  userId          Int      @unique
  age             Int?
  heightCm        Float?
  weightKg        Float?
  experienceLevel ExperienceLevel?
  user            User     @relation(fields: [userId], references: [id])
}

enum ExperienceLevel {
  beginner
  intermediate
  advanced
}

model Workout {
  id        Int      @id @default(autoincrement())
  userId    Int
  date      DateTime @default(now())
  notes     String?
  user      User     @relation(fields: [userId], references: [id])
  exercises WorkoutExercise[]
}

model Exercise {
  id   Int    @id @default(autoincrement())
  name String @unique
  category         String?
  createdAt        DateTime          @default(now())

  workoutExercises WorkoutExercise[]
}

model WorkoutExercise {
  id         Int      @id @default(autoincrement())
  workoutId  Int
  exerciseId Int
  workout    Workout  @relation(fields: [workoutId], references: [id])
  exercise   Exercise @relation(fields: [exerciseId], references: [id])
  sets       WorkoutSet[]
}

model WorkoutSet {
  id               Int      @id @default(autoincrement())
  workoutExerciseId Int
  weightKg         Float?
  reps             Int?
  durationSec      Int?
  workoutExercise  WorkoutExercise @relation(fields: [workoutExerciseId], references: [id])
}

model Goal {
  id          Int      @id @default(autoincrement())
  userId      Int
  type        GoalType
  exerciseId  Int?
  targetValue Float
  currentValue Float @default(0)
  completed   Boolean @default(false)
  user        User    @relation(fields: [userId], references: [id])
}

enum GoalType {
  lift_weight
  workout_frequency
  body_weight
}
